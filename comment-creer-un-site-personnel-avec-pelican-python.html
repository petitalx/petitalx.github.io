<!DOCTYPE html>
<html lang="fr">
  <head>
        <title>Alexandre Petit - Comment créer un site personnel avec Pelican (Python)</title>
      <meta charset="utf-8" />
      <meta name="generator" content="Pelican" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="stylesheet" type="text/css" href="https://petitalx.github.io/theme/css/style.css" />
      <link rel="stylesheet" type="text/css" href="https://petitalx.github.io/theme/css/code.css" />
      <script>
      function copyToClipboard(button) {
          const codeElement = button.nextElementSibling.querySelector('code');
          const codeText = codeElement.innerText || codeElement.textContent;

          navigator.clipboard.writeText(codeText).then(() => {
              // Provide feedback to the user
              button.textContent = 'Copied!';
              setTimeout(() => {
                  button.textContent = 'Copy code';
              }, 2000);
          }).catch(err => {
              console.error('Could not copy text: ', err);
          });
      }
      </script>

      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-4M6L1RW9VR"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-4M6L1RW9VR');
      </script>

        <link href="https://petitalx.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Alexandre Petit Full Atom Feed" />
        <link href="https://petitalx.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Alexandre Petit Full RSS Feed" />




  </head>

  <body>
    <header>
      <hgroup><h1><a href="https://petitalx.github.io/">Alexandre Petit</a></h1></hgroup>
    </header>
    <main>
  <article>
    <header>
      <h2>Comment créer un site personnel avec Pelican (Python)</h2>
    </header>
    <p>Hello ! </p>
<p>Dans cet article, on va voir comment créer un site personnel :</p>
<ul>
<li>avec le générateur de site statique Pelican (écrit en Python)</li>
<li>hébergé sur Github Pages</li>
<li>à partir de contenu Markdown</li>
</ul>
<p>Le résultat final ressemble à <a href="http://petitalx.io/">ça</a>. </p>
<p><em>If you don't give a shit about</em> le contexte et mon processus de décision, tu peux sauter directement à la section "Créer le site". Si à un moment tu es perdu dans les explications, tu peux toujours regarder le <a href="https://github.com/petitalx/petitalx.github.io">code source de mon site</a>.</p>
<h2>Contexte</h2>
<p>Cela fait plusieurs mois que j'expérimente différents supports d'écriture :</p>
<ul>
<li>je me suis lancé sur <a href="https://www.linkedin.com/in/petitalx/">LinkedIn</a></li>
<li>j'ai créé une <a href="https://100produits.substack.com/">newsletter sur Substack</a></li>
<li>j'écris deux pages par jour dans un carnet physique depuis 20 jours</li>
</ul>
<p>Une difficulté que je rencontre est que je n'ai pas de ligne éditoriale claire, pas de promesse. </p>
<p>J'ai envie d'écrire sur des sujets variés : </p>
<ul>
<li>de retours d'expérience de projets techniques</li>
<li>des "récits" de voyage</li>
<li>des points d'avancement de projet</li>
<li>des tutoriels</li>
<li>des résumés de livres</li>
<li>des réflexions</li>
<li>...</li>
</ul>
<p>Et je n'ai pas envie de m'imposer de façon "push". </p>
<p>Pour ces deux raisons, un site personnel me semble être une bonne solution.</p>
<p>Aussi je veux réaliser 30 projets en Python en complément de The Developer's Brain. Créer un site personnel en python apparaît comme bon challenge !</p>
<h2>Cadrer le projet</h2>
<p>Ma motivation est de "claim a personal domain", de m'installer dans un coin de la carte.</p>
<p>Ce qui va être important pour moi est de :</p>
<ul>
<li>livrer</li>
<li>choisir une solution simple</li>
<li>avoir un processus de décision clair dans le choix des technologies</li>
<li>faire un projet en python pour pousser mon expertise sur ce langage</li>
</ul>
<p>Les risques que je perçois sont : </p>
<ul>
<li>de tomber dans un rabbit hole lors du choix de la technologie</li>
<li>de me torturer le cerveau pour choisir une solution d'hébergement</li>
<li>de choisir un outil trop complexe pour mon besoin</li>
</ul>
<p>OK.</p>
<p>À présent, je suis mis en garde.</p>
<h2>Choisir la technologie</h2>
<p>Pour créer un site avec Python, j'ai d'abord pensé aux technologies suivantes : </p>
<ul>
<li>Django : un framework fullstack populaire pour créer des applications web</li>
<li>Flask : un framework léger pour créer des applications web</li>
</ul>
<p>Je me suis posé la question </p>
<blockquote>
<p>Quelle framework choisir pour créer un site personnel ?</p>
</blockquote>
<p>Je suis tombé sur ce fil Reddit <a href="https://www.reddit.com/r/Python/comments/166xf22/best_framework_for_portfolio_website/">Best framework for portfolio website?</a>.</p>
<p>Les réponses sont unanimes : utiliser Django ou Flask revient à se compliquer la vie. Un générateur de site statique est plus simple, moins cher et plus rapide.</p>
<p>Un générateur de sites statique est une application qui prends en entrée des fichiers textes et les converti en fichiers HTML.</p>
<p>Les générateurs de site statique ont les avantages suivants : 
- Simplicité : ils sont en général plus simple à appréhender que les frameworks Fullstack qui présentent davantage de fonctionnalités comme de l'authentification, des interactions avec une base de donnée. 
- Prix : il existe de nombreuses solutions d'hébergement gratuit
- SEO : les pages sont statiques et donc facilement indexables par les moteurs de recherche</p>
<p>Je me suis donc tourné vers les générateurs de site statique.</p>
<h2>Choisir un générateur de site statique</h2>
<p>Les solutions les plus tendances sont : </p>
<ul>
<li>Jekyll</li>
<li>Hugo</li>
<li>Astro</li>
</ul>
<p><strong>Jekyll</strong> existe depuis 2008. L'outil est écrit en Ruby. Plus de <a href="https://trends.builtwith.com/fr/cms/Jekyll">180k</a> sites web sont construit avec, et c'est la technologie qui est proposée par défaut pour Github Pages. Il bénéficie communauté, d'un écosystème de plugins. La <a href="https://jekyllrb.com/showcase/">galerie</a> démontre qu'il est possible de faire des sites esthétiques et complets avec. </p>
<p><strong>Hugo</strong> existe depuis 2013. Il est écrit en Go et se veut le générateur statique le plus rapide (en termes de compilation). Il est utilisé par <a href="https://trends.builtwith.com/fr/cms/Hugo">presque 300k sites</a>. Il dispose de fonctionnalités de localisation, et peut être associé à des frameworks CSS comme Tailwind. </p>
<p><strong>Astro</strong> est un générateur de site statique qui permet de combiner Svelte, React et Vue. Je l'ai tout de suite écarté car un wrapper autour de frameworks indique une complexité élevée. </p>
<p>Et python ?</p>
<p>Il existe bien un générateur de sites statiques en python : Pelican.</p>
<p><strong>Pelican</strong> existe depuis 2010 et a été créé par <a href="http://blog.notmyidea.org/">Alexis Metaireau</a>. Il est utilisé par seulement <a href="https://trends.builtwith.com/websitelist/Pelican">3500 sites</a>, mais il dispose d'une documentation claire. Et comme il est écrit en python, je pourrai contribuer au code source au besoin. Au première abord, il dispose de toutes les fonctionnalités dont j'ai besoin : il y a une section blog, des pages on peut ajuster le style.</p>
<p>Je choisis donc Pelican.</p>
<h2>Choisir une solution de déploiement</h2>
<p>Il existe des dizaines de solutions pour déployer un site statique, parmi lesquelles :</p>
<ul>
<li>AWS</li>
<li>Netlify</li>
<li>Github Pages</li>
<li>Mon propre serveur</li>
</ul>
<p>Je veux une solution gratuite et simple.</p>
<p>J'ai entendu beaucoup de bien de Github Pages. </p>
<p>Je vais tester cette solution.</p>
<h2>Créer le site</h2>
<p>Ok, on entre dans le vif du sujet.</p>
<p>Dans la suite de l'article, on va suivre ensemble les étapes que j'ai suivi pour construire mon site personnel https://petitalx.io. </p>
<blockquote>
<p><code>petitalx</code> est mon username Github. Naturellement, vous pouvez remplacer toutes les occurrences de <code>petitalx</code> par votre username. Vous ne pourrez pas copier coller toutes les instructions. Mais cela fera travailler votre mémoire mécanique :).</p>
</blockquote>
<h3>Créer un walking skeleton</h3>
<p>Notre premier objectif est de configurer et déployer un site le plus rapidement possible. On pourra ensuite itérer pour ajuster le style, ajouter du contenu, et simplifier le code.</p>
<p>Pré-requis :</p>
<ul>
<li>avoir un terminal unix</li>
<li>avoir Python installé</li>
<li>avoir un compte Github</li>
<li>connaître le ba-ba de git</li>
</ul>
<h4>Initialisation du projet</h4>
<p>On commence par créer le projet en local.</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/dev
mkdir<span class="w"> </span>petitalxio
<span class="nb">cd</span><span class="w"> </span>petitalxio

python<span class="w"> </span>--version<span class="w"> </span>
python<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>.venv
<span class="nb">source</span><span class="w"> </span>.venv/bin/activate
</code></pre></div>

<p>Créer un fichier requirements.txt avec la ligne<code>pelican[markdown]</code> :</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code><span class="n">echo</span><span class="w"> </span><span class="ss">&quot;pelican[markdown]&quot;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>
</code></pre></div>

<p>Puis installer les dépendances</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</code></pre></div>

<p>Lancer l'assistant de création de site</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code>pelican-quickstart
</code></pre></div>

<ul>
<li>créer le site dans un dossier <code>_pelican</code> </li>
<li>choisir <code>fr</code> comme langue par défaut</li>
<li>ne pas expliciter de préfixe d'url</li>
<li>désactiver la pagination</li>
<li>renseigner <code>Europe/Paris</code> comme timezone</li>
<li>demander à générer le fichier Makefile</li>
<li>répondre pour l'upload avec FTP, SSH, Dropbox, S3 et Rackspace</li>
<li>répondre oui à la question "Do you want to upload your website using GitHub Pages?"</li>
<li>répondre ui à la question "Is it your personal page" ?</li>
</ul>
<p>OK ! </p>
<p>Pour visionner le site en local, lancer les commandes</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/dev/petitalxio/_pelican
pelican<span class="w"> </span>content
pelican<span class="w"> </span>--listen
</code></pre></div>

<p><img alt="" src="images/creer-son-site-personnel-avec-pelican-et-ghp-2.png"></p>
<blockquote>
<p>Remarque : vous pouvez ensuite supprimer le dossier <code>_pelican/output</code> car dans la section suivante nous allons changer le chemin de sortie des fichiers.</p>
</blockquote>
<h4>Publier sur Github Pages</h4>
<p>Rendez-vous sur votre compte Github : https://github.com/. </p>
<p>Créer un nouveau repository <code>username.github.io</code> où <code>username</code> est votre nom d'utilisateur Github. Ne pas initialiser le README ni le .gitignore à ce stade.</p>
<p>De retour sur votre poste, se replacer à la racine du projet</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/dev/petitalxio<span class="sb">`</span>
</code></pre></div>

<p>Créer un fichier <code>.gitignore</code> avec le contenu suivant</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code>.venv  
**__pycache__**/
</code></pre></div>

<p>(par exemples avec la commande <code>echo ".venv \n**__pycache__**/" &gt; .gitignore</code>)</p>
<p>Initialiser le dépôt git</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;# petitalx.github.io&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>init
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;first commit&quot;</span>
git<span class="w"> </span>branch<span class="w"> </span>-M<span class="w"> </span>main
git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>origin<span class="w"> </span>https://github.com/petitalx/petitalx.github.io.git
git<span class="w"> </span>push<span class="w"> </span>-u<span class="w"> </span>origin<span class="w"> </span>main
</code></pre></div>

<p>La façon la plus simple de déployer le site est de générer le contenu du site à la racine du répertoire. Pour faciliter les manipulations, on va modifier le <code>Makefile</code> afin que la commande <code>make publish</code> génère le site à la racine du répertoire.</p>
<p>Ouvrir le fichier <code>_pelican/Makefile</code> et modifier la ligne <code>OUTPUTDIR</code> tel que</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code><span class="nv">OUTPUTDIR</span><span class="o">=</span><span class="k">$(</span>BASEDIR<span class="k">)</span>/..
</code></pre></div>

<p>Lancer <code>make publish</code> depuis <code>~/dev/petitalxio/_pelican</code>.</p>
<p>Depuis la racine du répertoire, lancer </p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code>git<span class="w"> </span>status
git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;generate content&quot;</span>
git<span class="w"> </span>push
</code></pre></div>

<p>Vérifier que le déploiement est en cours dans le volet "<strong>Actions</strong>" du répertoire Github :</p>
<p><img alt="" src="images/creer-son-site-personnel-avec-pelican-et-ghp-3.png"></p>
<p>Une fois le déploiement terminé, votre site est accessible à l'adresse <code>https://username.github.io</code></p>
<p><img alt="" src="images/premiere-mise-en-ligne.png"></p>
<p>Notre site personnel est en ligne ! </p>
<p>🚀</p>
<h3>Ajouter les premiers contenus</h3>
<p>Dans cette section, on va voir :</p>
<ul>
<li>comment créer une nouvelle page</li>
<li>comment créer un nouvel article</li>
<li>comment publier les mises à jour</li>
</ul>
<blockquote>
<p>Depuis le dossier <code>_pelican</code>, lancer la commande <code>make devserver</code> afin de lancer le serveur et d'activer le mode auto-reload. Le mode auto-reload va générer les fichiers html locaux de façon automatique dès lors qu'un fichier est modifié.</p>
</blockquote>
<h4>Création d'une page now</h4>
<p>À quoi bon créer un site personnel si l'on y met pas une page "now" ? 🤷‍♂️.</p>
<p>Une page now est une page qui indiquer au visiteur ce que l'on fait actuellement. Ton portfolio donne une bonne idée de ce que tu as réalisé par le passé. Ta page now donne un aperçu de ce qui t'occupe actuellement. </p>
<p>L'idée est de mettre dedans ce que tu raconterais à un amis que tu n'as pas vue depuis un an : </p>
<ul>
<li>où est-ce que tu vis </li>
<li>quels sont tes challenges</li>
<li>sur quels projets est-ce que tu travailles</li>
</ul>
<p>Créer un fichier <code>now.md</code> dans le dossier <code>~/dev/petitalxio/_pelican/content/pages</code> : </p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code>---
<span class="gu">Title: Now</span>
<span class="gu">---</span>

<span class="k">&gt; </span><span class="ge">Mis à jour le 28 juillet 2024 à Rouen, France.</span>

Je travail actuellement pour EDF en tant que Software Engineer où je développe un service de détection d&#39;anomalies sur des séries temporelles.

Mon axe de travail sur les prochains mois sont de rassembler et synthétiser les 99 meilleurs livres sur le Software Engineering. 

En complément de ce projet axé sur la théorie, je réalise réaliser 100 challenges en Python. Ce site constitue l&#39;un des challenges.
</code></pre></div>

<p>Et regarder le résultat sur la page http://127.0.0.1:8000</p>
<p>Si vous cherchez des exemples de pages "now", consultez </p>
<ul>
<li>https://sive.rs/now (la page du boss)</li>
<li>https://nownownow.com/ (l'annuaire des pages now)</li>
</ul>
<h4>Création d'un premier article</h4>
<p>Créer un fichier <code>mon-premier-article.md</code> dans le dossier <code>~/dev/petitalxio/_pelican/content/</code> : </p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code>Title: J&#39;ai publié mon premier article !
Date: 2024-07-27

Hello les amis.

Voici mon premier article de blog. 

Il est expose les différents formats de markdown

Une liste non numérotée : 

<span class="k">-</span><span class="w"> </span>a
<span class="k">-</span><span class="w"> </span>b

Une liste numérotée : 

<span class="k">1.</span> Cookie
<span class="k">2.</span> Beurre

Une citation 

<span class="k">&gt; </span><span class="ge">When the student is ready, the master will appear - Bruce Lee</span>

Un échantillon de code <span class="sb">`print(&quot;hello&quot;)`</span>
</code></pre></div>

<h4>Visualiser et publier les mises à jour</h4>
<p>Pour visionner le résultat en local, lancer : </p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/dev/petitalxio/_pelican
make<span class="w"> </span>devserver
</code></pre></div>

<p>Pour déployer, lancer</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/dev/petitalxio/_pelican
make<span class="w"> </span>publish

<span class="nb">cd</span><span class="w"> </span>~/dev/petitalxio/
git<span class="w"> </span>add<span class="w"> </span>.<span class="w"> </span><span class="p">;</span><span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;update content&quot;</span><span class="p">;</span><span class="w"> </span>git<span class="w"> </span>push
</code></pre></div>

<p>Vous avez maintenant toutes les clés en main pour ajouter du contenu sur votre site. </p>
<p>Pour aller plus loin, <a href="https://docs.getpelican.com/en/stable/content.html">la documentation</a> est là pour vous aider.</p>
<h3>Mettre en forme</h3>
<p>À présent que l'on a travaillé le fond, passons à la forme. </p>
<p>Dans cette section, je te propose de faire évoluer le design de notre site personnel vers <a href="https://petitalx.io/">ce style</a>, qui est un mélange entre <a href="https://sive.rs/">le site personnel de Derek Sivers</a>, et la simplicité de http://bettermotherfuckingwebsite.com/</p>
<p>Pour cela, on va repartir d'un thème "simple".</p>
<h4>Mise en place d'un thème explicite</h4>
<ul>
<li>récupérer les fichiers suivants https://github.com/getpelican/pelican/tree/main/pelican/themes/simple/templates et les copier dans <code>_pelican/themes/petitalxio/templates</code></li>
<li>ajouter <code>THEME = "themes/petitalxio"</code> dans <code>pelicanconf.py</code></li>
<li>régénérer le site </li>
</ul>
<p>Tout est à plat ! </p>
<p><img alt="" src="images/site-avec-theme-simple.png"></p>
<h4>Ajout d'une feuille de style CSS</h4>
<p>Coller le contenu suivant dans un fichier <code>_pelican/themes/petitalxio/static/style.css</code></p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">650</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="kt">px</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">font</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="kt">px</span><span class="o">/</span><span class="mf">1.5</span><span class="w"> </span><span class="o">-</span><span class="n">apple-system</span><span class="p">,</span><span class="w"> </span><span class="n">BlinkMacSystemFont</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Segoe UI&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Roboto</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Helvetica Neue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Arial</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Noto Sans&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Apple Color Emoji&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Segoe UI Emoji&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Segoe UI Symbol&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Noto Color Emoji&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#444</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">h1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nt">a</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#444</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">@</span><span class="k">media</span><span class="w"> </span><span class="o">(</span><span class="nt">prefers-color-scheme</span><span class="o">:</span><span class="w"> </span><span class="nt">dark</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#c9d1d9</span><span class="p">;</span>
<span class="w">    </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="mh">#0d1117</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nt">a</span><span class="p">:</span><span class="nd">link</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#58a6ff</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Puis ajouter la référence à la feuille de style dans le fichier template <code>base.html</code> :</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    {% block head %}
      <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{{ SITENAME|striptags }}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span> <span class="p">/&gt;</span>
      <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;generator&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;Pelican&quot;</span> <span class="p">/&gt;</span>

      <span class="cm">&lt;!-- 👇👇👇👇👇👇👇 --&gt;</span>
      <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ SITEURL }}/theme/style.css&quot;</span> <span class="p">/&gt;</span>
      <span class="cm">&lt;!-- 👆👆👆👆👆👆👆 --&gt;</span>

      <span class="cm">&lt;!-- ... suite du template --&gt;</span>
</code></pre></div>

<p>Régénérer, et le tour est joué.</p>
<p><img alt="" src="images/site-avec-theme-bettermotherfuckingwebsite.png"></p>
<blockquote>
<p>Attention, pour que pelican embarque la feuille de style sans configuration supplémentaire, il est nécessaire qu'elle se trouve dans un dossier qui soit nommé "static" placé à la racine du thème. L'exemple <code>themes/petitalxio/static/style.css</code> valide ces conditions. </p>
</blockquote>
<p>Finalement, lancer les commandes suivantes afin de déployer votre site web :</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code>shell
<span class="nb">cd</span><span class="w"> </span>~/dev/petitalxio/_pelican
make<span class="w"> </span>publish

<span class="nb">cd</span><span class="w"> </span>..
git<span class="w"> </span>status<span class="w">  </span>
git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;update website&quot;</span>
git<span class="w"> </span>push
</code></pre></div>

<h4>Simplifier le template</h4>
<p>On va à présent simplifier les templates suivants : </p>
<ul>
<li><code>base.html</code></li>
<li><code>index.html</code></li>
<li><code>page.html</code></li>
<li><code>article.html</code></li>
</ul>
<p>Commençons par le fichier <code>base.html</code> : </p>
<p><img alt="" src="images/simplify-base-screenshot.jpg"></p>
<ul>
<li>supprimer le bloc <code>&lt;nav&gt;</code></li>
<li>supprimer le bloc <code>&lt;footer&gt;</code></li>
</ul>
<p>Continuer avec <code>index.html</code> : </p>
<p><img alt="" src="images/simplify-index-template.png"></p>
<ul>
<li>remplacer le <code>{% block content_title %}</code>par un simple <code>&lt;h2&gt;</code> et en profiter pour traduire le texte</li>
<li>remplacer la liste de miniatures par une simple liste de titres d'articles</li>
<li>supprimer le bloc dédié à la pagination car on l'a désactivé pendant le quickstart</li>
</ul>
<p>Poursuivre avec le template article.html : </p>
<p><img alt="" src="images/simplify-article-template.png"></p>
<ul>
<li>supprimer les directives liées à la traduction</li>
<li>simplifier l'affichage du titre pour utiliser une simple balise <code>&lt;h2&gt;</code></li>
<li>supprimer les blocs de métadonnée du footer liée à l'auteur, à la catégorie et aux tags</li>
</ul>
<p>Et terminer avec <code>page.html</code></p>
<p><img alt="" src="images/simplify-page-template.jpg"></p>
<h4>Création d'une page Home personnalisée</h4>
<p>Créer un fichier <code>home.md</code> dans `_pelican/content/pages/</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code>---  
Title: Home
---  

<span class="gu">## Moi en 10 secondes  </span>

Je suis un développeur Python.  

Je suis né à Rouen.  

Et j&#39;habite actuellement à Rouen.
</code></pre></div>

<blockquote>
<p><code>[now](now)</code> résulte en un lien html relatif à la l'url courante. Si on est à l'url <code>petitalx.io/pages/home.html</code>, cela donne <code>petitalx.io/pages/now</code>. Le pré-processeur <code>{filename}</code> ne semble pas fonctionner chez moi.</p>
</blockquote>
<p>Ajouter les lignes suivantes dans le fichier <code>pelicanconf.py</code>. Cela va créer une variable globale <code>HOME</code> qui va contenir le contenu HTML.  </p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code><span class="c1"># En tête de fichier :</span>
<span class="kn">from</span> <span class="nn">pelican.readers</span> <span class="kn">import</span> <span class="n">MarkdownReader</span>  
<span class="kn">from</span> <span class="nn">pelican.settings</span> <span class="kn">import</span> <span class="n">DEFAULT_CONFIG</span>

<span class="c1"># Plus bas :</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">DEFAULT_CONFIG</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  
<span class="n">HOME</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">MarkdownReader</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;content/pages/home.md&quot;</span><span class="p">)</span>
</code></pre></div>

<p>On peut à présent faire injecter le contenu de la variable HOME dans le template de l'index. Ajouter la ligne <code>{{ HOME }}</code> à la suite de la ligne <code>{% block content %}</code> dans le fichier <code>_pelican/themes/petitalxio/templates/index.html</code>. Le début de votre fichier doit alors resembler à cela : </p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code>{% extends &quot;base.html&quot; %}  
{% block content %}  

    {{ HOME }}
</code></pre></div>

<p>Régénérer, et admirer le résultat.</p>
<p><img alt="" src="images/creer-son-site-personnel-avec-pelican-et-ghp-4.png"></p>
<h3>BONUS : Code minimalism</h3>
<p>Ok, on a bien simplifié le design ! </p>
<p>Maintenant, j'aimerais simplifier le code. </p>
<p>Cette étape peut paraître superflu. 
Mais vous allez voir, après on se sent mieux.</p>
<p>Chaque fichier, chaque ligne de code qui est dans notre projet représente un cout. C'est une ligne de plus à lire lorsque l'on cherche à faire évoluer notre site, un fichier en plus à maintenir, une information supplémentaire à traiter.</p>
<p>Dans cette section, on va éliminer le code inutile. </p>
<h4>Ne plus générer les pages qui ne nous servent pas</h4>
<p>Commencer par désactiver la génération des pages "Author", "Authors", "Tag", ... en ajoutant ces lignes au fichier <code>pelicanconf.py</code> :</p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code>TAG_SAVE_AS = &#39;&#39;  
TAGS_SAVE_AS = &#39;&#39;  
CATEGORY_SAVE_AS = &#39;&#39;  
CATEGORIES_SAVE_AS = &#39;&#39;  
AUTHOR_SAVE_AS = &#39;&#39;  
AUTHORS_SAVE_AS = &#39;&#39;  
ARCHIVES_SAVE_AS = &#39;&#39;
</code></pre></div>

<p>Nettoyer le dossier des templates pour ne conserver que les 4 fichiers suivants : </p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code>templates
├── article.html
├── base.html
├── index.html
├── page.html
</code></pre></div>

<h4>Nettoyer le fichier de configuration</h4>
<p>Nettoyer le fichier <code>pelicanconf.py</code>
<img alt="" src="images/pelican-website-conf.jpg">
- supprimer la variable <code>LINKS</code> : c'était une variable custom du template initial
- supprimer la variable <code>SOCIAL</code> : idem, elle ne sert plus
- supprimer la variable <code>DEFAULT_PAGINATION</code> qui utilise déjà la valeur par défaut
- supprimer le code commenté relatif à <code>RELATIVE_URLS</code>
- supprimer le lignes qui annulent la génération du feed</p>
<h4>Nettoyer le Makefile</h4>
<p>Le Makefile généré par <code>pelican-quickstart</code> met à disposition des commandes utiles.</p>
<p>Je te propose de ne conserver que le strict minimum pour développer efficacement : 
- <code>help</code> : affiche l'aide du Makefile
- <code>clean</code> : supprime les fichiers HTML et XML de sortie
- <code>devserver</code> : lance le serveur local et le hot reload
- <code>publish</code> : génère le site la config serveur
- <code>github</code> : génère le site et upload notre repository sur Github</p>
<p>En regardant le détail de commande, on se rend compte que la commande <code>clean</code> est dangereuse en l'état. Comme on génère le site à la racine du repo, lancer <code>make clean</code> entraine la suppression de tous nos fichiers !</p>
<p>Aussi, la commande Github utilise <code>ghp</code>. Ce n'est pas l'option que nous avons choisi pour déployer. </p>
<p>Voici la version du fichier mise à jour (à partir de la ligne help) : </p>
<div class="highlight">
<button class="copy-button" onclick="copyToClipboard(this)">Copy code</button><pre><span></span><code><span class="nf">help</span><span class="o">:</span>
<span class="w">    </span>@echo<span class="w"> </span><span class="s1">&#39;Makefile for a pelican Web site                                           &#39;</span>
<span class="w">    </span>@echo<span class="w"> </span><span class="s1">&#39;                                                                          &#39;</span>
<span class="w">    </span>@echo<span class="w"> </span><span class="s1">&#39;Usage:                                                                    &#39;</span>
<span class="w">    </span>@echo<span class="w"> </span><span class="s1">&#39;   make clean                          remove the generated files         &#39;</span>
<span class="w">    </span>@echo<span class="w"> </span><span class="s1">&#39;   make publish                        generate using production settings &#39;</span>
<span class="w">    </span>@echo<span class="w"> </span><span class="s1">&#39;   make devserver [PORT=8000]          serve and regenerate together      &#39;</span>
<span class="w">    </span>@echo<span class="w"> </span><span class="s1">&#39;   make github                         upload the web site                &#39;</span>
<span class="w">    </span>@echo<span class="w"> </span><span class="s1">&#39;                                                                          &#39;</span>
<span class="w">    </span>@echo<span class="w"> </span><span class="s1">&#39;Set the DEBUG variable to 1 to enable debugging, e.g. make DEBUG=1 html   &#39;</span>
<span class="w">    </span>@echo<span class="w"> </span><span class="s1">&#39;Set the RELATIVE variable to 1 to enable relative urls                    &#39;</span>
<span class="w">    </span>@echo<span class="w"> </span><span class="s1">&#39;                                                                          &#39;</span>

<span class="nf">clean</span><span class="o">:</span>
<span class="w">    </span>rm<span class="w"> </span><span class="k">$(</span>OUTPUTDIR<span class="k">)</span>/**.html<span class="p">;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>OUTPUTDIR<span class="k">)</span><span class="s2">/feeds&quot;</span><span class="p">;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>OUTPUTDIR<span class="k">)</span><span class="s2">/pages&quot;</span><span class="p">;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>OUTPUTDIR<span class="k">)</span><span class="s2">/theme&quot;</span>

<span class="nf">devserver</span><span class="o">:</span>
<span class="w">    </span><span class="s2">&quot;</span><span class="k">$(</span>PELICAN<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>-lr<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>INPUTDIR<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>OUTPUTDIR<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>CONFFILE<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">$(</span>PELICANOPTS<span class="k">)</span>

<span class="nf">publish</span><span class="o">:</span>
<span class="w">    </span><span class="s2">&quot;</span><span class="k">$(</span>PELICAN<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>INPUTDIR<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>OUTPUTDIR<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>PUBLISHCONF<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">$(</span>PELICANOPTS<span class="k">)</span>

<span class="nf">github</span><span class="o">:</span><span class="w"> </span><span class="n">publish</span>
<span class="w">    </span>git<span class="w"> </span>add<span class="w"> </span>-A
<span class="w">    </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Update site&quot;</span>
<span class="w">    </span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span><span class="k">$(</span>GITHUB_PAGES_BRANCH<span class="k">)</span>


<span class="nf">.PHONY</span><span class="o">:</span><span class="w"> </span><span class="n">help</span> <span class="n">clean</span> <span class="n">devserver</span> <span class="n">publish</span> <span class="n">github</span>
</code></pre></div>

<p>Enfin, il est aussi possible de supprimer le fichier <code>_pelican/tasks.py</code> qui fait doublon avec notre Makefile.</p>
<p>Et voilà.</p>
<p>Le projet est finalement très simple :)</p>
<h2>Conclusion</h2>
<ul>
<li>Mes notes de second cerveau</li>
<li>J'ai pris une décision confiant !!</li>
</ul>
<p>Ressources utiles </p>
<ul>
<li>La documentation de Pelican : https://docs.getpelican.com/en/stable/index.html</li>
<li>La documentation de Github Pages : https://pages.github.com/</li>
</ul>
<p>Je pose ici quelques pistes pour aller plus loin avec Pelican : </p>
<ul>
<li>créer son propre générateur</li>
<li>créer son propre plugin</li>
<li>créer le thème <em>bettermotherfuckingwebsite</em> pour contribuer</li>
<li>prendre une <a href="https://github.com/getpelican/pelican/issues">issue</a></li>
</ul>
    <footer>
      <p>Published: <time datetime="2024-07-27T00:00:00+02:00">
        Sam 27 juillet 2024
      </time></p>
    </footer>
  </article>
    </main>
  </body>
</html>